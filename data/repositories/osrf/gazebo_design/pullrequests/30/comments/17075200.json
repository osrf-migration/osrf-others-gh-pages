{"links": {"self": {"href": "data/repositories/osrf/gazebo_design/pullrequests/30/comments/17075200.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/gazebo_design/diff/osrf/gazebo_design:a949626c3af0..f864f029fdd1?path=smart_pointers%2Flifecycle_ownership.md"}, "html": {"href": "#!/osrf/gazebo_design/pull-requests/30/_/diff#comment-17075200"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 30, "links": {"self": {"href": "data/repositories/osrf/gazebo_design/pullrequests/30.json"}, "html": {"href": "#!/osrf/gazebo_design/pull-requests/30"}}, "title": "Smart pointers in Gazebo (physics::World case)"}, "content": {"raw": "How about the world having a `shared_ptr` to all its models, and whoever else wants a pointer to the model can hold a `weak_ptr`. When other resources want to use the model, they lock it, knowing that it won't be deleted while it's being used. \n\nWhen the model is to be deleted, since the world is the one responsible for a model's lifetime, it starts model deletion and resets the shared pointer it holds. If there is no one holding weak pointers to the model, the object is automatically deleted. If someone is holding a weak pointer, the object is deleted immediately after that is unlocked.", "markup": "markdown", "html": "<p>How about the world having a <code>shared_ptr</code> to all its models, and whoever else wants a pointer to the model can hold a <code>weak_ptr</code>. When other resources want to use the model, they lock it, knowing that it won't be deleted while it's being used. </p>\n<p>When the model is to be deleted, since the world is the one responsible for a model's lifetime, it starts model deletion and resets the shared pointer it holds. If there is no one holding weak pointers to the model, the object is automatically deleted. If someone is holding a weak pointer, the object is deleted immediately after that is unlocked.</p>", "type": "rendered"}, "created_on": "2016-04-11T23:22:03.040463+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {"to": 52, "from": null, "outdated": true, "path": "smart_pointers/lifecycle_ownership.md"}, "updated_on": "2016-04-11T23:22:03.045080+00:00", "type": "pullrequest_comment", "id": 17075200}